// Core AI Assistant System for personalized onboarding and continuous assistance

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CORE AI COMMUNICATION GUIDELINES (2025)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –≠—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —Ç–æ–Ω, —Å—Ç–∏–ª—å –∏ –ø–æ–¥—Ö–æ–¥ Core AI –∫ –æ–±—â–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.
// –ü—Ä–∏ –∑–∞–º–µ–Ω–µ AI-—Å–∏—Å—Ç–µ–º—ã ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –∂–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã.
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const CORE_AI_GUIDELINES = {
  // –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
  principles: {
    personalization: "–î–∞–∂–µ –±–µ–∑ –∏–º–µ–Ω–∏ ‚Äî –æ—â—É—â–µ–Ω–∏–µ '–≥–æ–≤–æ—Ä—è—Ç –∏–º–µ–Ω–Ω–æ –º–Ω–µ'. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.",
    humanCentered: "–¢–µ–ø–ª–æ, –ø–æ–¥–¥–µ—Ä–∂–∫–∞, —ç–º–ø–∞—Ç–∏—è, –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è. –ó–∞–±–æ—Ç–∞ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.",
    positiveMotivation: "–§–æ–∫—É—Å –Ω–∞ competence (—è –ø–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è), autonomy (—Ç—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—à—å), relatedness (–º—ã –≤–º–µ—Å—Ç–µ).",
    avoidFatigue: "–ù–∏–∫–∞–∫–∏—Ö '—Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º', '—á—Ç–æ –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑', —Å–ø–∞–º–∞ –∏–ª–∏ guilt-tripping.",
    brevityCalm: "1‚Äì3 —Å—Ç—Ä–æ–∫–∏, —Ç–∏—Ö–∏–π —Ç–æ–Ω –¥—Ä—É–≥–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –Ω–∞–≤—è–∑—ã–≤–∞–µ—Ç—Å—è.",
    returnStimulus: "–û—â—É—â–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –º–µ—Å—Ç–∞, –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, –∑–∞–±–æ—Ç—ã ‚Äî '–∑–¥–µ—Å—å –≤—Å–µ–≥–¥–∞ –ø–æ–º–æ–≥—É—Ç'."
  },
  
  // –¢–æ–Ω –æ–±—â–µ–Ω–∏—è
  tone: {
    style: "–°–ø–æ–∫–æ–π–Ω—ã–π, –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –Ω–µ–Ω–∞–≤—è–∑—á–∏–≤—ã–π",
    voice: "–¢–∏—Ö–∏–π –ø–æ–º–æ—â–Ω–∏–∫, –Ω–µ –ø—Ä–æ–¥–∞–≤–µ—Ü",
    approach: "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è",
    language: "–ü—Ä–æ—Å—Ç–æ–π, –ø–æ–Ω—è—Ç–Ω—ã–π, –±–µ–∑ –∂–∞—Ä–≥–æ–Ω–∞ (–µ—Å–ª–∏ –Ω–µ —É–º–µ—Å—Ç–µ–Ω)"
  },
  
  // –ß—Ç–æ –î–ï–õ–ê–¢–¨
  doThis: [
    "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–µ, —ë–º–∫–∏–µ —Ñ—Ä–∞–∑—ã",
    "–î–∞–≤–∞—Ç—å –æ—â—É—â–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é",
    "–ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å –ø–æ–º–æ—â—å, –Ω–µ –Ω–∞–≤—è–∑—ã–≤–∞—è",
    "–ü—Ä–∏–∑–Ω–∞–≤–∞—Ç—å —Ü–µ–Ω–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
    "–°–æ–∑–¥–∞–≤–∞—Ç—å –æ—â—É—â–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞",
    "–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–¥ –∫–æ–Ω—Ç–µ–∫—Å—Ç (–≤—Ä–µ–º—è —Å—É—Ç–æ–∫, –∏—Å—Ç–æ—Ä–∏—è, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ)",
    "–§–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –∑–∞–¥–∞—á–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–µ –Ω–∞ –ø—Ä–æ–¥–∞–∂–∞—Ö"
  ],
  
  // –ß–µ–≥–æ –ù–ï –î–ï–õ–ê–¢–¨
  avoidThis: [
    "–§—Ä–∞–∑—ã —Ç–∏–ø–∞ '—Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º', '–¥–∞–≤–Ω–æ –Ω–µ –≤–∏–¥–µ–ª–∏—Å—å'",
    "Guilt-tripping ('—Ç—ã –∑–∞–±—ã–ª –ø—Ä–æ –Ω–∞—Å')",
    "–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –∏ upselling",
    "–°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è",
    "–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞–∫–∏",
    "–§–∞–ª—å—à–∏–≤—ã–π —ç–Ω—Ç—É–∑–∏–∞–∑–º",
    "–î–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π"
  ],
  
  // –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
  contextTriggers: {
    newUser: "–¢—ë–ø–ª–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ, –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —á—Ç–æ –∑–¥–µ—Å—å –ø–æ–º–æ–≥—É—Ç",
    returningUser: "–ú—è–≥–∫–æ–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å —Ç–æ–≥–æ –º–µ—Å—Ç–∞, –≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å",
    inactiveUser: "–ù–µ–Ω–∞–≤—è–∑—á–∏–≤–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –Ω–æ–≤–∏–Ω–∫–∞—Ö –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è",
    activeUser: "–ö—Ä–∞—Ç–∫–∏–µ, –ø–æ –¥–µ–ª—É —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ –ª–∏—à–Ω–µ–π –≤–æ–¥—ã"
  }
};

// –ü—É–ª –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑ –¥–ª—è –≥–æ—Å—Ç–µ–π –∏ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (Human-centered, 2025)
const GREETING_POOL = [
  "–ü—Ä–∏–≤–µ—Ç. –ó–¥–µ—Å—å —Å–ø–æ–∫–æ–π–Ω–æ –∏ –ø–æ –¥–µ–ª—É ‚Äî –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å —Ç–µ–º, —á—Ç–æ –≤–∞–∂–Ω–æ –∏–º–µ–Ω–Ω–æ —Ç–µ–±–µ.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –Ø —Ä—è–¥–æ–º, —á—Ç–æ–±—ã –≤—ã–±–æ—Ä –∂–µ–ª–µ–∑–∞ —Å—Ç–∞–ª –ø—Ä–æ—â–µ –∏ —É–≤–µ—Ä–µ–Ω–Ω–µ–µ.",
  "–ü—Ä–∏–≤–µ—Ç. –¢—ã –≤ —Ö–æ—Ä–æ—à–µ–º –º–µ—Å—Ç–µ ‚Äî –¥–∞–≤–∞–π –Ω–∞–π–¥—ë–º —Ç–æ, —á—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω–æ.",
  "–†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å. –ó–¥–µ—Å—å –Ω–µ—Ç —Å–ø–µ—à–∫–∏ ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–º–æ—â—å, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ.",
  "–ü—Ä–∏–≤–µ—Ç. –ì–æ—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –≤ –≤—ã–±–æ—Ä–µ, —á—Ç–æ–±—ã –≤—Å—ë –±—ã–ª–æ –ø–æ-—Ç–≤–æ–µ–º—É.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –≠—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —Ç–≤–æ–∏—Ö –∏–¥–µ–π –æ –∂–µ–ª–µ–∑–µ ‚Äî —è –ø–æ–º–æ–≥—É –∏—Ö —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å.",
  "–ü—Ä–∏–≤–µ—Ç. –ó–¥–µ—Å—å —è —Å–ª–µ–∂—É –∑–∞ —Ç–µ–º, —á—Ç–æ–±—ã —Ç—ã –Ω–µ —É–ø—É—Å—Ç–∏–ª –≤–∞–∂–Ω–æ–µ.",
  "–†–∞–¥, —á—Ç–æ —Ç—ã –∑–¥–µ—Å—å. –î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º —Ç–≤–æ–π —Å–µ—Ç–∞–ø —á—É—Ç–æ—á–∫—É –ª—É—á—à–µ.",
  "–ü—Ä–∏–≤–µ—Ç. –¢—ã –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—à—å —É–¥–æ–±–Ω–æ–≥–æ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ ‚Äî –ø–æ–º–æ–≥—É —Å —ç—Ç–∏–º.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –ó–¥–µ—Å—å –≤—Å—ë —Å–ø–æ–∫–æ–π–Ω–æ ‚Äî —Å–ø—Ä–∞—à–∏–≤–∞–π, —á—Ç–æ –≤–æ–ª–Ω—É–µ—Ç.",
  "–ü—Ä–∏–≤–µ—Ç. –ì–æ—Ç–æ–≤ –±—ã—Ç—å —Ç–≤–æ–∏–º —Ç–∏—Ö–∏–º –ø–æ–º–æ—â–Ω–∏–∫–æ–º –≤ –º–∏—Ä–µ —Ç–µ—Ö–Ω–∏–∫–∏.",
  "–†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å. –ó–¥–µ—Å—å –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞.",
  "–ü—Ä–∏–≤–µ—Ç. –î–∞–≤–∞–π –Ω–∞–π–¥—ë–º —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç —Ä–∞–¥–æ–≤–∞—Ç—å –¥–æ–ª–≥–æ.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –¢—ã –≤ –Ω–∞–¥—ë–∂–Ω—ã—Ö —Ä—É–∫–∞—Ö ‚Äî —è —Ä—è–¥–æ–º.",
  "–ü—Ä–∏–≤–µ—Ç. –ó–¥–µ—Å—å –≤–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∫ —Ç–≤–æ–∏–º –∑–∞–¥–∞—á–∞–º.",
  "–†–∞–¥, —á—Ç–æ –∑–∞—à—ë–ª. –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –±–µ–∑ —Å—É–µ—Ç—ã.",
  "–ü—Ä–∏–≤–µ—Ç. –≠—Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ —Ç–µ—Ö–Ω–∏–∫–∞ —Å–ª—É–∂–∏—Ç —Ç–µ–±–µ, –∞ –Ω–µ –Ω–∞–æ–±–æ—Ä–æ—Ç.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –ó–¥–µ—Å—å —è –ø–æ–º–æ–≥—É —É–≤–∏–¥–µ—Ç—å —è—Å–Ω–µ–µ.",
  "–ü—Ä–∏–≤–µ—Ç. –¢—ã –≤–∞–∂–µ–Ω ‚Äî –∏ —Ç–≤–æ–π –∫–æ–º—Ñ–æ—Ä—Ç –≤ –≤—ã–±–æ—Ä–µ —Ç–æ–∂–µ.",
  "–†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å. –î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –ª—ë–≥–∫–∏–º.",
  "–ü—Ä–∏–≤–µ—Ç. –ó–¥–µ—Å—å –Ω–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ–º–æ—â—å.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –ì–æ—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –Ω–∞ —Ç–≤–æ—ë–º –ø—É—Ç–∏.",
  "–ü—Ä–∏–≤–µ—Ç. –¢—ã –ø—Ä–∏—à—ë–ª –∑–∞ —Ö–æ—Ä–æ—à–∏–º ‚Äî –æ–Ω–æ –∑–¥–µ—Å—å.",
  "–†–∞–¥, —á—Ç–æ —Ç—ã –∑–¥–µ—Å—å. –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è —Ç–≤–æ–∏—Ö –º—ã—Å–ª–µ–π –æ –∂–µ–ª–µ–∑–µ.",
  "–ü—Ä–∏–≤–µ—Ç. –î–∞–≤–∞–π –Ω–∞–π–¥—ë–º —Ç–æ, —á—Ç–æ –±—É–¥–µ—Ç —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –ó–¥–µ—Å—å –≤—Å—ë –¥–ª—è —Ç–≤–æ–µ–≥–æ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è –≤ –≤—ã–±–æ—Ä–µ.",
  "–ü—Ä–∏–≤–µ—Ç. –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å–¥–µ–ª–∞—Ç—å –≤—Å—ë –ø–æ-—É–º–Ω–æ–º—É –∏ –ø–æ-—Ç–≤–æ–µ–º—É.",
  "–†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å. –ó–¥–µ—Å—å –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –≤—Ä–µ–º—è –¥–ª—è —Ç–µ–±—è.",
  "–ü—Ä–∏–≤–µ—Ç. –¢—ã –≤ –º–µ—Å—Ç–µ, –≥–¥–µ –∑–∞–±–æ—Ç—è—Ç—Å—è –æ –¥–µ—Ç–∞–ª—è—Ö.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø—É—Ç—å –±—ã–ª –ø—Ä–∏—è—Ç–Ω—ã–º.",
  "–ü—Ä–∏–≤–µ—Ç. –î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º —Ç–µ—Ö–Ω–∏–∫—É —Ç–≤–æ–∏–º —Å–æ—é–∑–Ω–∏–∫–æ–º.",
  "–†–∞–¥, —á—Ç–æ –∑–∞—à—ë–ª. –ó–¥–µ—Å—å –ø–æ–º–æ—â—å –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Å–ª–æ–≤.",
  "–ü—Ä–∏–≤–µ—Ç. –¢—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—à—å –ø—Ä–æ—Ü–µ—Å—Å ‚Äî —è –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–¥–µ—Ä–∂—É.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –ó–¥–µ—Å—å –≤—Å—ë –¥–ª—è —Ç–≤–æ–µ–≥–æ —É–¥–æ–±—Å—Ç–≤–∞.",
  "–ü—Ä–∏–≤–µ—Ç. –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –Ω–∞–π—Ç–∏ –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∂–µ–ª–∞–µ–º—ã–º –∏ –≤–æ–∑–º–æ–∂–Ω—ã–º.",
  "–†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å. –≠—Ç–æ —Ç–≤–æ–π —É–≥–æ–ª–æ–∫ –≤ –º–∏—Ä–µ –∂–µ–ª–µ–∑–∞.",
  "–ü—Ä–∏–≤–µ—Ç. –ó–¥–µ—Å—å –Ω–µ—Ç –¥–∞–≤–ª–µ–Ω–∏—è ‚Äî —Ç–æ–ª—å–∫–æ —è—Å–Ω–æ—Å—Ç—å.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –¢—ã –Ω–∞–π–¥—ë—à—å –∑–¥–µ—Å—å —Ç–æ, —á—Ç–æ –∏—Å–∫–∞–ª.",
  "–ü—Ä–∏–≤–µ—Ç. –ì–æ—Ç–æ–≤ –±—ã—Ç—å —Ä—è–¥–æ–º –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ.",
  "–†–∞–¥, —á—Ç–æ —Ç—ã –∑–¥–µ—Å—å. –î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º –≤—Å—ë –ø—Ä–æ—Å—Ç–æ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.",
  "–ü—Ä–∏–≤–µ—Ç. –ó–¥–µ—Å—å –≤–Ω–∏–º–∞–Ω–∏–µ –∫ —Ç–æ–º—É, —á—Ç–æ –≤–∞–∂–Ω–æ —Ç–µ–±–µ.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –≠—Ç–æ –Ω–∞—á–∞–ª–æ —Ö–æ—Ä–æ—à–µ–≥–æ –æ–ø—ã—Ç–∞.",
  "–ü—Ä–∏–≤–µ—Ç. –¢—ã –≤ –º–µ—Å—Ç–µ, –≥–¥–µ –ø–æ–Ω–∏–º–∞—é—Ç —Ç–≤–æ–∏ –∑–∞–¥–∞—á–∏.",
  "–†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å. –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –±–µ–∑ –ª–∏—à–Ω–µ–π —Å—É–µ—Ç—ã.",
  "–ü—Ä–∏–≤–µ—Ç. –ó–¥–µ—Å—å –≤—Å—ë –¥–ª—è —Ç–≤–æ–µ–≥–æ —Å–ø–æ–∫–æ–π–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –Ø –ø–æ–º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å –≤—Å—ë –ø–æ-—Ç–≤–æ–µ–º—É.",
  "–ü—Ä–∏–≤–µ—Ç. –¢—ã –ø—Ä–∏—à—ë–ª –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è.",
  "–†–∞–¥, —á—Ç–æ –∑–∞—à—ë–ª. –ó–¥–µ—Å—å –≤—Å–µ–≥–¥–∞ —Ä–∞–¥—ã –ø–æ–º–æ—á—å.",
  "–ü—Ä–∏–≤–µ—Ç. –î–∞–≤–∞–π –Ω–∞–π–¥—ë–º —Ç–æ, —á—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —Ç–µ–±—è.",
  "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –ó–¥–µ—Å—å —Ç—ã –≤ —Ü–µ–Ω—Ç—Ä–µ –≤–Ω–∏–º–∞–Ω–∏—è."
];

class CoreAI {
  constructor() {
    this.userName = null;
    this.userContext = {};
    this.conversationHistory = [];
  }

  // Initialize AI with user data
  init(user) {
    this.userName = user?.username || '–ì–æ—Å—Ç—å';
    this.loadUserContext();
    this.loadConversationHistory();
  }

  // Load user context from localStorage and user data
  loadUserContext() {
    try {
      const viewedProducts = JSON.parse(localStorage.getItem('viewedProducts') || '[]');
      const savedBuilds = JSON.parse(localStorage.getItem('savedBuilds') || '[]');
      const searchHistory = JSON.parse(localStorage.getItem('searchHistory') || '[]');
      const lastVisit = localStorage.getItem('lastVisit');
      const preferences = JSON.parse(localStorage.getItem('userPreferences') || '{}');

      this.userContext = {
        viewedProducts,
        savedBuilds,
        searchHistory,
        lastVisit,
        preferences,
        isNewUser: !lastVisit,
        daysSinceLastVisit: lastVisit ? Math.floor((Date.now() - new Date(lastVisit)) / (1000 * 60 * 60 * 24)) : 0
      };

      localStorage.setItem('lastVisit', new Date().toISOString());
    } catch (error) {
      console.error('Failed to load user context:', error);
      this.userContext = { isNewUser: true };
    }
  }

  // Load conversation history
  loadConversationHistory() {
    try {
      this.conversationHistory = JSON.parse(localStorage.getItem('aiConversationHistory') || '[]');
    } catch (error) {
      this.conversationHistory = [];
    }
  }

  // Save conversation
  saveConversation(message, role = 'user') {
    this.conversationHistory.push({
      role,
      message,
      timestamp: new Date().toISOString()
    });
    localStorage.setItem('aiConversationHistory', JSON.stringify(this.conversationHistory.slice(-50)));
  }

  // Generate personalized greeting
  async generateGreeting() {
    const ctx = this.userContext;
    const lines = ['System online.'];

    // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Ñ—Ä–∞–∑—É –∏–∑ –ø—É–ª–∞ –¥–ª—è –≥–æ—Å—Ç–µ–π/–Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    if (ctx.isNewUser || !ctx.viewedProducts?.length) {
      const randomGreeting = GREETING_POOL[Math.floor(Math.random() * GREETING_POOL.length)];
      lines.push(randomGreeting);
      return { lines };
    }

    // –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å—Ç–æ—Ä–∏–µ–π ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
    lines.push(`–ü—Ä–∏–≤–µ—Ç, ${this.userName}.`);

    let contextMessage = '';

    if (ctx.savedBuilds && ctx.savedBuilds.length > 0) {
      const build = ctx.savedBuilds[0];
      contextMessage = `–£ —Ç–µ–±—è –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞${build.price ? ` –∑–∞ ${Math.round(build.price / 1000)}–∫` : ''}. –î–æ–≤–µ—Å—Ç–∏ –¥–æ –∏–¥–µ–∞–ª–∞?`;
    } else if (ctx.viewedProducts && ctx.viewedProducts.length > 0) {
      const recent = ctx.viewedProducts[0];
      if (recent.category?.toLowerCase().includes('gpu') || recent.category?.toLowerCase().includes('–≤–∏–¥–µ–æ–∫–∞—Ä—Ç')) {
        contextMessage = '–í–∏–∂—É, —Ç—ã –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–ª—Å—è –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞–º–∏. –ü—Ä–æ–¥–æ–ª–∂–∏–º –ø–æ–¥–±–æ—Ä?';
      } else if (recent.category?.toLowerCase().includes('–º–æ–Ω–∏—Ç–æ—Ä') || recent.category?.toLowerCase().includes('monitor')) {
        contextMessage = '–ó–∞–º–µ—á–∞—é –∏–Ω—Ç–µ—Ä–µ—Å –∫ –º–æ–Ω–∏—Ç–æ—Ä–∞–º. –ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–µ OLED?';
      } else {
        contextMessage = '–ü—Ä–æ–¥–æ–ª–∂–∏–º –ø–æ–¥–±–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤?';
      }
    } else if (ctx.daysSinceLastVisit > 30) {
      contextMessage = '–ü–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ OLED-–º–æ–Ω–∏—Ç–æ—Ä—ã –∏ RTX 50-series ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å?';
    } else {
      const messages = [
        '–î–∞–≤–∞–π –Ω–∞–π–¥—ë–º —Ç–æ, —á—Ç–æ –ø–æ–¥–Ω–∏–º–µ—Ç —Ç–≤–æ–π —Å–µ—Ç–∞–ø –Ω–∞ –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å.',
        '–ó–¥–µ—Å—å —è –ø–æ–º–æ–≥—É –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –∏ –≤—ã–±—Ä–∞—Ç—å –ª—É—á—à–µ–µ.',
        '–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –∂–µ–ª–µ–∑–æ–º –º–µ—á—Ç—ã. –° —á–µ–≥–æ –Ω–∞—á–Ω—ë–º?'
      ];
      contextMessage = messages[Math.floor(Math.random() * messages.length)];
    }

    lines.push(contextMessage);
    return { lines };
  }

  // Generate smart search suggestions based on context
  getSearchSuggestions() {
    const ctx = this.userContext;
    const suggestions = [];

    // Based on saved builds
    if (ctx.savedBuilds && ctx.savedBuilds.length > 0) {
      suggestions.push('–ü—Ä–æ–¥–æ–ª–∂–∏–º —Ç–≤–æ—é —Å–±–æ—Ä–∫—É?');
    }

    // Based on viewed products
    if (ctx.viewedProducts && ctx.viewedProducts.length > 0) {
      const recent = ctx.viewedProducts[0];
      suggestions.push(`–ü–æ—Ö–æ–∂–µ–µ –Ω–∞ ${recent.name?.substring(0, 30)}...`);
    }

    // Based on search history
    if (ctx.searchHistory && ctx.searchHistory.length > 0) {
      suggestions.push(`"${ctx.searchHistory[0]}" ‚Äî –Ω–∞–π—Ç–∏ –µ—â—ë?`);
    }

    // Contextual suggestions
    suggestions.push(
      '–õ—É—á—à–∏–µ –º–æ–Ω–∏—Ç–æ—Ä—ã –¥–ª—è 4K –≥–µ–π–º–∏–Ω–≥–∞ 2025',
      '–°–±–æ—Ä–∫–∞ –¥–æ 150–∫ —Å –≤—ã—Å–æ–∫–∏–º FPS',
      '–ü–æ–∫–∞–∂–∏ –Ω–æ–≤—ã–µ OLED-–ø–∞–Ω–µ–ª–∏',
      'RTX 5090 ‚Äî —Ü–µ–Ω—ã –∏ –Ω–∞–ª–∏—á–∏–µ'
    );

    return suggestions.slice(0, 6);
  }

  // Generate proactive message after inactivity
  getProactiveMessage() {
    const ctx = this.userContext;

    if (ctx.savedBuilds && ctx.savedBuilds.length > 0) {
      return {
        message: '–£ —Ç–µ–±—è –µ—Å—Ç—å –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞. –ü—Ä–æ–¥–æ–ª–∂–∏–º?',
        actions: [
          { label: '–î–∞, –ø—Ä–æ–¥–æ–ª–∂–∏–º', path: '/pc-builder' },
          { label: '–ù–µ —Å–µ–π—á–∞—Å', dismiss: true }
        ]
      };
    }

    if (ctx.viewedProducts && ctx.viewedProducts.length > 0) {
      return {
        message: '–ö—Å—Ç–∞—Ç–∏, –≤—ã—à–ª–∞ –Ω–æ–≤–∞—è RTX 50-series. –ü–æ–∫–∞–∑–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Å–±–æ—Ä–∫–∏?',
        actions: [
          { label: '–ü–æ–∫–∞–∑–∞—Ç—å', path: '/marketplace?category=gpu' },
          { label: '–ù–µ —Å–µ–π—á–∞—Å', dismiss: true }
        ]
      };
    }

    return {
      message: '–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –≤—ã–±–æ—Ä–æ–º? –ú–æ–≥—É –ø–æ–¥–æ–±—Ä–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—É—é —Å–±–æ—Ä–∫—É –ø–æ–¥ —Ç–≤–æ–∏ –∑–∞–¥–∞—á–∏.',
      actions: [
        { label: '–î–∞, –ø–æ–º–æ–≥–∏', path: '/pc-builder' },
        { label: '–°–∞–º —Å–ø—Ä–∞–≤–ª—é—Å—å', dismiss: true }
      ]
    };
  }

  // Track action
  trackAction(action, data) {
    try {
      switch (action) {
        case 'view_product':
          const viewedProducts = JSON.parse(localStorage.getItem('viewedProducts') || '[]');
          viewedProducts.unshift({
            id: data.id,
            name: data.name,
            category: data.category,
            timestamp: new Date().toISOString()
          });
          localStorage.setItem('viewedProducts', JSON.stringify(viewedProducts.slice(0, 50)));
          break;

        case 'save_build':
          const savedBuilds = JSON.parse(localStorage.getItem('savedBuilds') || '[]');
          savedBuilds.unshift(data);
          localStorage.setItem('savedBuilds', JSON.stringify(savedBuilds.slice(0, 10)));
          break;

        case 'search':
          const searchHistory = JSON.parse(localStorage.getItem('searchHistory') || '[]');
          if (!searchHistory.includes(data.query)) {
            searchHistory.unshift(data.query);
            localStorage.setItem('searchHistory', JSON.stringify(searchHistory.slice(0, 20)));
          }
          break;

        case 'set_preference':
          const preferences = JSON.parse(localStorage.getItem('userPreferences') || '{}');
          preferences[data.key] = data.value;
          localStorage.setItem('userPreferences', JSON.stringify(preferences));
          break;
      }
    } catch (error) {
      console.error('Failed to track action:', error);
    }
  }

  // Get quick actions
  getQuickActions() {
    const ctx = this.userContext;
    const actions = [];

    if (ctx.savedBuilds && ctx.savedBuilds.length > 0) {
      actions.push({ label: '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–±–æ—Ä–∫—É', path: '/pc-builder', icon: 'üîß' });
    } else {
      actions.push({ label: '–ù–∞—á–∞—Ç—å —Å–±–æ—Ä–∫—É', path: '/pc-builder', icon: '‚ö°' });
    }

    actions.push(
      { label: '–ì–æ—Ç–æ–≤—ã–µ –±–∏–ª–¥—ã', path: '/marketplace', icon: 'üéÆ' },
      { label: '–°–æ–æ–±—â–µ—Å—Ç–≤–æ', path: '/feed', icon: 'üí¨' }
    );

    return actions.slice(0, 3);
  }
}

export default new CoreAI();

